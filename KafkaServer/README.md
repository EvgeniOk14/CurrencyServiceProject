# Микросервис - KafkaServer

## Краткое описание микросервиса:
 KafkaServer — это микросервис, который получает запросы через REST API от микросервиса "ApiGataway"
 и является продьюсером, т.е. передаёт эти запросы в топики Kafka ("fetch-currency-topic" и "query-currency-topic"), 
 которые слушают другие микросервисы ("FetchCurrencyService" и "QueryCurrencyService"). 
 Также я вляется консьюмером, т.е. слушает топик "response-topic", в которые передаются ответы на посланные запросы
 от других микросервисов, и после получения ответов, они передаются обратно в микросервис Gateway.
 При получении запросов данный микросервис формирует запрос для отправки его в нужный топик, при этом,
 формирует данный запрос в виде записи ProducerRecord, у которой есть полезная нагрузка payload и заголовок header в который входит:
 requestId - уникальный идентификатор запроса, для определения дублирующихся сообщений.
 Для отправки сообщений в топик используется пул потоков ExecutorService, который управляет выполнением задач асинхронно
 через метод submitTask. Это позволяет эффективно обрабатывать множество запросов одновременно,
 не блокируя основной поток.
 Для получения ответа на запрос используется CompletableFuture, который ожидает ответа от других микросервисов
 или выбрасывает исключение в случае ошибки. Это обеспечивает асинхронную обработку и управление состоянием запросов,
 позволяя легко обрабатывать результаты и исключения.
 Конфигурационный клас WebConfig служит для настройки CORS (Cross-Origin Resource Sharing), а именно настройка разрешенных источников, методов и других параметров, для работы с ApiGataway,
 от которого приходят запросы и к которому отсылаются ответы.
 Конфигурационный клас WebClientConfig используется для выполнения асинхронных HTTP-запросов в приложении.
 WebClient является частью Spring WebFlux и предоставляет удобный API для работы с веб-сервисами.
 WebFlux — это модуль Spring, который поддерживает реактивное программирование и предоставляет возможности
 для создания асинхронных, неблокирующих веб-приложений. Он основан на проекте Reactor и использует подход,
 который позволяет обрабатывать запросы и ответы не блокируя потоки, что особенно важно в сценариях с высокой нагрузкой.
 KafkaServer интегрирован с Prometheus для сбора метрик производительности и состояния системы.
 Prometheus позволяет отслеживать такие показатели, как время отклика, количество запросов, уровень ошибок
 и загрузка системы. Эти метрики помогают в оперативном анализе и выявлении узких мест в производительности.
 Для удобного отображения собранных метрик используется Grafana.
 С помощью Grafana можно создавать интерактивные дашборды, которые позволяют визуализировать данные в реальном
 времени. Это дает командам возможность быстро реагировать на изменения в производительности системы
 и принимать обоснованные решения на основе собранной информации.

## Проект поддерживает следующие функции:
- **Получение запросов от микросервиса "ApiGataway".**
- **Формирование запроса в нужный топик кафка.**
- **Получение ответа из топика ответов кафка.**
- **Обработка ответа и отправка в микросервис "ApiGataway".**
- **Документирование API с помощью Swagger.**


## Стек технологий
- **Java 21** - Java версия 21
- **Maven** - Инструмент для управления проектами и автоматизации сборки на Java.
- **Spring Boot 3.4.0** - Фреймворк для быстрой разработки микросервисов с автоматической конфигурацией
- **Spring WebFlux** - Реактивный фреймворк для создания асинхронных веб-приложений с низкой задержкой
- **Kafka** - брокер сообщений 
- **Swagger** — для документирования API.
- **Prometheus** - Система мониторинга и сбора метрик для анализа производительности приложений.
- **Grafana** - Платформа для визуализации данных и создания интерактивных дашбордов
- **Actuator** - Компонент Spring Boot для мониторинга и управления состоянием приложения
- **Eureka-client**- Клиентская библиотека для взаимодействия с Eureka Server,
   позволяющая микросервисам автоматически регистрироваться и обнаруживать другие сервисы
   в распределенной системе.

## Cписок путей всех контроллеров приложения (Конечные точки(endPoints)):
- **Доступные конечные точки:**
- **http://localhost:8081/currencies/all - Получает все доступные курсы валют.**
- **http://localhost:8081/currencies/single/{currencyCode} - Получает курс конкретной валюты.**
- **http://localhost:8081/currencies/filter/{filter} - Получает курсы валют по фильтру.**

## Доступ к приложению:
- **http://localhost:8081 <--- веб-интерфейс приложения.**
- **http://localhost:8081/swagger-ui/index.html <--- Swagger UI для тестирования API.**
- **http://localhost:8081/v3/api-docs <--- доступ к документации в браузере.**

## Документирование Swagger
-**http://localhost:8080/swagger-ui/index.html** - доступ к эндпоинтам контроллера
-**http://localhost:8080/v3/api-docs** -- доступ к документации Swagger

## Доступ к Actuator
-**http://localhost:8080/actuator** - доступ к Actuator (набор функций для мониторинга и управления приложением
на основе Spring Boot, предоставляет информацию о состоянии приложения и его метриках)
## Доступ к Prometheus:
**http://localhost:9090** - доступ к интерфейсу Prometheus для мониторинга и анализа собранных метрик.

## Доступ к Grafana
-**http://localhost:3000** - доступ к интерфейсу Grafana для визуализации метрик и создания интерактивных дашбордов
(Пользователь: admin и Пароль: admin, задано по умолчанию, рекомендуется изменить после первого входа)

